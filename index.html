<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | API-Test</title>
    <script src="main.js" defer></script>
</head>

<body>
    <div id="app">
        <form id="loginform">
            Login <input type="text" name="login" value=""><br>
            Password <input type="password" name="password" value=""><br>
            <input type="button" name="loginbutton" id="loginbutton" value="login" onclick="flogin(this.parentElement)">
            <input type="button" name="logoutbutton" id="logoutbutton" value="logout" onclick="flogout()">
            <input type="button" name="showbutton" id="showbutton" value="show" onclick="fshow()">
        </form>
    </div>
    <script>
        const api = "http://localhost:8777/api/v1/api.php"
        function flogin(frm) {
            console.log(frm)
            fdata = new formSerialize(frm);
            sendHttpRequest("POST", api + "?q=login")
                .then((data) => {
                    //console.log(JSON.stringify(data));
                    console.log(data);
                    window.localStorage.setItem("token", data.token)
                })
                .catch((error) => {
                    console.error(error);
                });
        }

        function flogout() {
            window.localStorage.removeItem("token")
            sendHttpRequest("POST", api + "?q=logout")
                .then((data) => {
                    console.log(data);
                })
                .catch((error) => {
                    console.error(error);
                });
        }

        function fshow(frm) {
            sendHttpRequest("POST", api + "?q=show")
                .then((data) => {
                    console.log(data);
                })
                .catch((error) => {
                    console.error(error);
                });
        }
    </script>
</body>

</html>